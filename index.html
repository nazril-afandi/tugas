<html>
  <head>
    <!-- Bootstrap -->
    <link 
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" 
      rel="stylesheet"
    />
    <style>
      .task-completed {
        text-decoration: line-through;
        color: gray;
      }
      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
    </style>
  </head>
  <body>
    <div id="apps"></div>

    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/jsx">
      // Komponen untuk menampilkan tiap tugas
      function TodoItem({ task, onToggle, onEdit, onDelete }) {
        return (
          <div className="card p-2 mb-2 fade-in">
            <div className="d-flex align-items-center">
              <input
                type="checkbox"
                checked={task.completed}
                onChange={() => onToggle(task.id)}
                className="mr-3"
              />
              <span
                className={task.completed ? "task-completed flex-grow-1" : "flex-grow-1"}
              >
                {task.text}
              </span>
              <button onClick={() => onEdit(task.id)} className="btn btn-warning btn-sm ml-2">Edit</button>
              <button onClick={() => onDelete(task.id)} className="btn btn-danger btn-sm ml-2">Delete</button>
            </div>
          </div>
        );
      }

      // Komponen utama
      function TodoList() {
        const [tasks, setTasks] = React.useState([]);
        const [newTask, setNewTask] = React.useState("");
        const [editingTaskId, setEditingTaskId] = React.useState(null);
        const [editingText, setEditingText] = React.useState("");
        const [filter, setFilter] = React.useState("all"); // "all", "completed", "pending"

        const addTask = () => {
          if (newTask.trim() === "") return;
          setTasks([...tasks, { id: Date.now(), text: newTask, completed: false }]);
          setNewTask("");
        };

        const toggleTask = (id) => {
          setTasks(tasks.map(task =>
            task.id === id ? { ...task, completed: !task.completed } : task
          ));
        };

        const editTask = (id) => {
          const task = tasks.find(t => t.id === id);
          setEditingTaskId(id);
          setEditingText(task.text);
        };

        const saveEdit = () => {
          setTasks(tasks.map(task =>
            task.id === editingTaskId ? { ...task, text: editingText } : task
          ));
          setEditingTaskId(null);
          setEditingText("");
        };

        const deleteTask = (id) => {
          setTasks(tasks.filter(task => task.id !== id));
        };

        const clearCompleted = () => {
          setTasks(tasks.filter(task => !task.completed));
        };

        const totalTasks = tasks.length;
        const completedTasks = tasks.filter(t => t.completed).length;
        const pendingTasks = totalTasks - completedTasks;

        // Filter tugas
        const filteredTasks = tasks.filter(task => {
          if (filter === "completed") return task.completed;
          if (filter === "pending") return !task.completed;
          return true; // all
        });

        return (
          <div className="container mt-4">
            <h1 className="text-center mb-4">ðŸ“˜ Website Tugas Sekolah</h1>
            
            <div className="card p-3 shadow-sm mb-4">
              <div className="input-group mb-3">
                <input
                  type="text"
                  value={newTask}
                  onChange={(e) => setNewTask(e.target.value)}
                  placeholder="Tambah Tugas Sekolah"
                  className="form-control"
                />
                <div className="input-group-append">
                  <button onClick={addTask} className="btn btn-primary">Tambah</button>
                </div>
              </div>

              {editingTaskId && (
                <div className="input-group mb-3">
                  <input
                    type="text"
                    value={editingText}
                    onChange={(e) => setEditingText(e.target.value)}
                    className="form-control"
                  />
                  <div className="input-group-append">
                    <button onClick={saveEdit} className="btn btn-success">Simpan</button>
                  </div>
                </div>
              )}
            </div>

            {/* Statistik */}
            <div className="alert alert-info d-flex justify-content-between">
              <span>Total: {totalTasks}</span>
              <span>Selesai: {completedTasks}</span>
              <span>Belum: {pendingTasks}</span>
            </div>

            {/* Tombol Filter */}
            <div className="btn-group mb-3">
              <button
                className={`btn btn-outline-primary ${filter === "all" ? "active" : ""}`}
                onClick={() => setFilter("all")}
              >
                Semua
              </button>
              <button
                className={`btn btn-outline-success ${filter === "completed" ? "active" : ""}`}
                onClick={() => setFilter("completed")}
              >
                Selesai
              </button>
              <button
                className={`btn btn-outline-warning ${filter === "pending" ? "active" : ""}`}
                onClick={() => setFilter("pending")}
              >
                Belum
              </button>
            </div>

            {/* Daftar Tugas */}
            <div>
              {filteredTasks.length > 0 ? (
                filteredTasks.map((task) => (
                  <TodoItem
                    key={task.id}
                    task={task}
                    onToggle={toggleTask}
                    onEdit={editTask}
                    onDelete={deleteTask}
                  />
                ))
              ) : (
                <p className="text-center text-muted">Tidak ada tugas untuk ditampilkan</p>
              )}
            </div>

            {completedTasks > 0 && (
              <button onClick={clearCompleted} className="btn btn-outline-danger mt-3">
                Hapus Semua Tugas Selesai
              </button>
            )}
          </div>
        );
      }

      // Render aplikasi
      ReactDOM.render(<TodoList />, document.getElementById('apps'));
    </script>
  </body>
</html>
